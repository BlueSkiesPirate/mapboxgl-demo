<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simple Landing Page</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.js"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: #f5f5f5;
      color: #222;
    }

    header {
      padding: 1.5rem 2rem;
      text-align: center;
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    header p { font-size: 1rem; color: #555; }

    .map-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 2rem;
      width:100%;
      height:100vh;
      gap: 12px;
    }

    #map { width:100%; height:100%; border-radius: 20px; }

    .marker {
      position: relative;
      background-size: contain;
      background-position-x: 50%;
      background-repeat: no-repeat;
      border-radius: 50%;
      cursor: pointer;
      transition-property: width, height;
      transition-duration: 0.1s;
      transition-timing-function: linear;
      animation:
        pop-in 0.3s ease-out forwards,
        wobble 1.5s ease-in-out 0.3s forwards;
      transform-origin: bottom center;
    }

    .marker::before {
      content: '';
      width: 0;
      height: 0;
      border-left: 7px solid transparent;
      border-right: 7px solid transparent;
      border-top: 7px solid #365874;
      display: block;
      position: absolute;
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
    }

    @keyframes pop-in {
      0% { width: 0px; height: 0px; opacity: 0; box-shadow: none; }
      70% { width: 55px; height: 55px; opacity: 1; box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.4); }
      85% { width: 48px; height: 48px; box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.3); }
      100% { width: 50px; height: 50px; box-shadow: 0px 0px 6px rgba(0, 0, 0, 0.3); }
    }

    @keyframes wobble {
      0% { transform: rotate(0deg); }
      20% { transform: rotate(2.5deg); }
      50% { transform: rotate(-2deg); }
      65% { transform: rotate(1deg); }
      100% { transform: rotate(0deg); }
    }

    #map-data{
      display: flex;
      justify-content: space-around;
      width: 100%;
    }

    #legend{
      width:200px;
      background: #fff;
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.08);
    }

    #filters-container{
      display: flex;
      align-items: center;
      gap: 18px;
      background: #fff;
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.08);
      width: fit-content;
    }

    #filters-container h1{
      font-size: 16px;
      margin-right: 6px;
    }

    .filter {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filter h2{
      font-size: 14px;
      font-weight: 600;
    }

    .btn-dot{
      border-radius: 50%;
      width: 18px;
      height: 18px;
      cursor: pointer;
      border: 2px solid #111;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }

    #purpleBtn{ background-color: #63054e; }
    #redBtn{ background-color: #ff4d4d; }
    #blueBtn{ background-color: #2b6cff; }
    #yellowBtn{ background-color: gold; } /* âœ… add a real yellow button id */

    .legend_type_container{
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 6px;
    }

    #redCircle{ background-color: #ff4d4d; }
    #blueCircle{ background-color: #2b6cff; }
    #yellowCircle{ background-color: gold; } /* âœ… kits legend dot */

    .legend-type{
      border-radius: 50%;
      width: 18px;
      height: 18px;
      border: 2px solid #111;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }

    .active-filter{
      outline: 3px solid rgba(0,0,0,0.15);
      outline-offset: 3px;
    }

    footer {
      padding: 1rem;
      text-align: center;
      font-size: 0.9rem;
      color: #777;
      background: #ffffff;
      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
    }
  </style>
</head>

<body id="background">
  <header>
    <h1>MapBox Test</h1>
    <p>A simple landing page with a map</p>
  </header>

  <section class="map-container">
    <div id="map"></div>

    <div id="map-data">
      <div id="legend">
        <h3>legend</h3>
        <div class="legend_type_container">
          <p>partners:</p><div id="redCircle" class="legend-type" title="partners"></div>
        </div>
        <div class="legend_type_container">
          <p>resources:</p><div id="blueCircle" class="legend-type" title="resources"></div>
        </div>
        <div class="legend_type_container">
          <p>kits:</p><div id="yellowCircle" class="legend-type" title="kits"></div>
        </div>
      </div>

      <div id="filters-container">
        <h1>Filters</h1>

        <div class="filter">
          <h2>Show all</h2>
          <div id="purpleBtn" class="btn-dot active-filter" title="Show all"></div>
        </div>

        <div class="filter">
          <h2>Show partners</h2>
          <div id="redBtn" class="btn-dot" title="Show partners"></div>
        </div>

        <div class="filter">
          <h2>Show resources</h2>
          <div id="blueBtn" class="btn-dot" title="Show resources"></div>
        </div>

        <div class="filter">
          <h2>Show kits</h2>
          <div id="yellowBtn" class="btn-dot" title="Show kits"></div> <!-- âœ… fix id + label -->
        </div>
      </div>
    </div>
  </section>

  <footer>
    Â© 2026 Â· All rights reserved
  </footer>

  <script>
  mapboxgl.accessToken =
    "pk.eyJ1Ijoic2ViYXN0aWFucmV5bmEiLCJhIjoiY21qMzd3YXQ5MTRvdzNlcHZxcGc3cjAxNCJ9.wPxfrdtV25plDeVFOnyIOA";

  // --------------------------------------------------
  // BOUNDS
  // --------------------------------------------------

  // Hard pan limits (user cannot pan outside NY region)
  const maxBounds = [
    [-79.76, 40.49],
    [-71.85, 45.01]
  ];

  // ðŸ‘‡ THIS defines the exact area you always want visible
  const viewBounds = [
    [-74.10, 40.58], // southwest
    [-73.95, 40.87]  // northeast
  ];

  // Responsive padding so UI doesnâ€™t cover the map
  function getPadding() {
    return window.innerWidth < 768
      ? { top: 20, bottom: 160, left: 20, right: 20 }
      : { top: 40, bottom: 40, left: 40, right: 40 };
  }

  // --------------------------------------------------
  // MAP INIT
  // --------------------------------------------------

  const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/mapbox/standard",
    projection: "globe",
    center: [-73.96801, 40.72490],
    maxBounds: maxBounds
  });

  map.addControl(new mapboxgl.NavigationControl());
  map.scrollZoom.disable();

  map.on("load", () => {
    map.fitBounds(viewBounds, {
      padding: getPadding(),
      duration: 0
    });

    map.setFog({});
  });

  // Keep the same geographic area on resize
  window.addEventListener("resize", () => {
    map.fitBounds(viewBounds, {
      padding: getPadding(),
      duration: 0
    });
  });

  // --------------------------------------------------
  // MARKERS + FILTER SYSTEM
  // --------------------------------------------------

  const markerRegistry = []; // { marker, popup, lngLat, type, element }

  function setMarkerVisible(item, visible) {
    item.element.style.display = visible ? "" : "none";
    if (!visible && item.popup) item.popup.remove();
  }

  function applyFilter(type) {
    markerRegistry.forEach(item => {
      const show = type === "all" || item.type === type;
      setMarkerVisible(item, show);
    });
  }

  function setActiveBtn(activeId) {
    document.querySelectorAll(".btn-dot").forEach(b =>
      b.classList.remove("active-filter")
    );
    document.getElementById(activeId).classList.add("active-filter");
  }

  function addHoverMarker({ lngLat, element, title, type, address }) {
    const popup = new mapboxgl.Popup({
      closeButton: false,
      closeOnClick: false,
      offset: 18
    }).setHTML(`<h2>${title} (${type})</h2><h3>${address}</h3>`);

    element.addEventListener("mouseenter", () =>
      popup.addTo(map).setLngLat(lngLat)
    );
    element.addEventListener("mouseleave", () => popup.remove());

    // Border color by type
    if (type === "resource") {
      element.firstChild.style.border = "2px solid #2b6cff";
    } else if (type === "partner") {
      element.firstChild.style.border = "2px solid #ff4d4d";
    } else if (type === "kit") {
      element.firstChild.style.border = "2px solid gold";
    } else {
      element.firstChild.style.border = "2px solid #111";
    }

    const marker = new mapboxgl.Marker({ element })
      .setLngLat(lngLat)
      .addTo(map);

    markerRegistry.push({ marker, popup, lngLat, type, element });
  }

  // --------------------------------------------------
  // MARKERS
  // --------------------------------------------------

  function createMarker(img) {
    const wrap = document.createElement("div");
    const m = document.createElement("div");
    m.className = "marker";
    m.style.backgroundImage = `url('${img}')`;
    wrap.appendChild(m);
    return wrap;
  }

  addHoverMarker({
    lngLat: [-73.98513, 40.7589],
    element: createMarker("./img1.png"),
    title: "Place one",
    type: "partner",
    address: "123 banana Street"
  });

  addHoverMarker({
    lngLat: [-73.78513, 40.7589],
    element: createMarker("./img2.png"),
    title: "Place two",
    type: "partner",
    address: "123 banana Street"
  });

  addHoverMarker({
    lngLat: [-73.86513, 40.7589],
    element: createMarker("./img3.png"),
    title: "Place three",
    type: "kit",
    address: "123 banana Street"
  });

  addHoverMarker({
    lngLat: [-73.88513, 40.7589],
    element: createMarker("./img4.png"),
    title: "Place four",
    type: "resource",
    address: "123 banana Street"
  });

  // --------------------------------------------------
  // FILTER BUTTONS
  // --------------------------------------------------

  document.getElementById("purpleBtn").onclick = () => {
    setActiveBtn("purpleBtn");
    applyFilter("all");
  };

  document.getElementById("redBtn").onclick = () => {
    setActiveBtn("redBtn");
    applyFilter("partner");
  };

  document.getElementById("blueBtn").onclick = () => {
    setActiveBtn("blueBtn");
    applyFilter("resource");
  };

  document.getElementById("yellowBtn").onclick = () => {
    setActiveBtn("yellowBtn");
    applyFilter("kit");
  };

  applyFilter("all");
</script>

</body>
</html>
