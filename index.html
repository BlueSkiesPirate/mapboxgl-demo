<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simple Landing Page</title>
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.js"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: Arial, Helvetica, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: #f5f5f5;
      color: #222;
    }

    header {
      padding: 1.5rem 2rem;
      text-align: center;
      background: #ffffff;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    header h1 { font-size: 2rem; margin-bottom: 0.5rem; }
    header p { font-size: 1rem; color: #555; }

    .map-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 2rem;
      width:100%;
      height:100vh;
      gap: 12px;
    }

    #map { width:100%; height:100%; border-radius: 20px; }

    /* ---- marker (your existing animated marker) ---- */
    .marker {
      position: relative;
      background-size: contain;
      background-position-x: 50%;
      background-repeat: no-repeat;
      border-radius: 50%;
      cursor: pointer;
      transition-property: width, height;
      transition-duration: 0.1s;
      transition-timing-function: linear;
      animation:
        pop-in 0.3s ease-out forwards,
        wobble 1.5s ease-in-out 0.3s forwards;
      transform-origin: bottom center;
    }

    .marker::before {
      content: '';
      width: 0;
      height: 0;
      border-left: 7px solid transparent;
      border-right: 7px solid transparent;
      border-top: 7px solid #365874;
      display: block;
      position: absolute;
      bottom: -5px;
      left: 50%;
      transform: translateX(-50%);
    }

    @keyframes pop-in {
      0% { width: 0px; height: 0px; opacity: 0; box-shadow: none; }
      70% { width: 55px; height: 55px; opacity: 1; box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.4); }
      85% { width: 48px; height: 48px; box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.3); }
      100% { width: 50px; height: 50px; box-shadow: 0px 0px 6px rgba(0, 0, 0, 0.3); }
    }

    @keyframes wobble {
      0% { transform: rotate(0deg); }
      20% { transform: rotate(2.5deg); }
      50% { transform: rotate(-2deg); }
      65% { transform: rotate(1deg); }
      100% { transform: rotate(0deg); }
    }
#map-data{
  display: flex;
  justify-content: space-around;
  width: 100%;
}
#legend{
  width:200px;
  background: #fff;
  padding: 10px 14px;
  border-radius: 14px;
  box-shadow: 0 8px 22px rgba(0,0,0,0.08);
}
    /* ---- filters UI ---- */
    #filters-container{
      display: flex;
      align-items: center;
      gap: 18px;
      background: #fff;
      padding: 10px 14px;
      border-radius: 14px;
      box-shadow: 0 8px 22px rgba(0,0,0,0.08);
      width: fit-content;
    }
    #filters-container h1{
      font-size: 16px;
      margin-right: 6px;
    }
    .filter {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .filter h2{
      font-size: 14px;
      font-weight: 600;
    }
    .btn-dot{
      border-radius: 50%;
      width: 18px;
      height: 18px;
      cursor: pointer;
      border: 2px solid #111;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }
    #purpleBtn{ background-color: #63054e; }
    #redBtn{ background-color: #ff4d4d; }
    #blueBtn{ background-color: #2b6cff; }

    .legend_type_container{
display: flex;
    }
    #redCircle{
 background-color: #ff4d4d;
    }

    #blueCircle{
background-color: #2b6cff;
    }

    .legend-type{
      border-radius: 50%;
      width: 18px;
      height: 18px;
      border: 2px solid #111;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    }
    /* optional: show which filter is active */
    .active-filter{
      outline: 3px solid rgba(0,0,0,0.15);
      outline-offset: 3px;
    }

    footer {
      padding: 1rem;
      text-align: center;
      font-size: 0.9rem;
      color: #777;
      background: #ffffff;
      box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.05);
    }
  </style>
</head>

<body id="background">
  <header>
    <h1>MapBox Test</h1>
    <p>A simple landing page with a map</p>
  </header>

  <section class="map-container">
    <div id="map"></div>

<div id="map-data">


    <div id="legend">
      <h3>legend</h3>
     <div class="legend_type_container"> <P>partners: </P><div id="redCircle" class="legend-type" title="Show partners"></div></div>
     <div class="legend_type_container"> <P>resources: </P><div id="blueCircle" class="legend-type" title="Show partners"></div></div>
    </div>

    <div id="filters-container">
      <h1>Filters</h1>

      <div class="filter">
        <h2>Show all</h2>
        <div id="purpleBtn" class="btn-dot active-filter" title="Show all"></div>
      </div>

      <div class="filter">
        <h2>Show partners</h2>
        <div id="redBtn" class="btn-dot" title="Show partners"></div>
      </div>

      <div class="filter">
        <h2>Show resources</h2>
        <div id="blueBtn" class="btn-dot" title="Show resources"></div>
      </div>
    </div>
    </div>
  </section>

  <footer>
    © 2025 Your Name · All rights reserved
  </footer>

  <script>
    mapboxgl.accessToken = "pk.eyJ1Ijoic2ViYXN0aWFucmV5bmEiLCJhIjoiY21qMzd3YXQ5MTRvdzNlcHZxcGc3cjAxNCJ9.wPxfrdtV25plDeVFOnyIOA"; // put your token back here
//"";
    const nyBounds = [
      [-79.76, 40.49],
      [-71.85, 45.01]
    ];

    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/standard',
      projection: 'globe',
      zoom: 10,
      center: [-73.96801, 40.77724],
      maxBounds: nyBounds,
    });

    map.addControl(new mapboxgl.NavigationControl());
    map.scrollZoom.disable();

    // ----------------------------
    // MARKER REGISTRY + FILTERING
    // ----------------------------
    // we'll store markers so we can show/hide them later
    const markerRegistry = []; // [{ marker, popup, lngLat, type, element }]

    function setMarkerVisible(item, visible) {
      // hide/show via CSS so we don't destroy the marker
      item.element.style.display = visible ? '' : 'none';
      // make sure hover popup doesn't linger if we hide
      if (!visible && item.popup) item.popup.remove();
    }

    function applyFilter(type) {
      // type: 'all' | 'partner' | 'resource'
      markerRegistry.forEach(item => {
        const shouldShow = (type === 'all') || (item.type === type);
        setMarkerVisible(item, shouldShow);
      });
    }

    function setActiveBtn(activeId) {
      document.querySelectorAll('.btn-dot').forEach(b => b.classList.remove('active-filter'));
      document.getElementById(activeId).classList.add('active-filter');
    }

    // ---------------------------------------------------------------------------
    // Helper: create a hover-popup marker + register with a type (partner/resource)
    function addHoverMarker({ lngLat, element, title, type, address }) {
      const popup = new mapboxgl.Popup({
        closeButton: false,
        closeOnClick: false,
        offset: 18
      }).setHTML(`<h2>${title}, ${type} </h2><h3>${address}</h3>`);

      element.addEventListener('mouseenter', () => popup.addTo(map).setLngLat(lngLat));
      element.addEventListener('mouseleave', () => popup.remove());
      if (type == "resource"){
        element.firstChild.style.border ="2px solid #2b6cff";
      }else{
         element.firstChild.style.border ="2px solid #ff4d4d";
      }
      const marker = new mapboxgl.Marker({ element }).setLngLat(lngLat).addTo(map);

      markerRegistry.push({ marker, popup, lngLat, type, element });
      return marker;
    }

    // ---------------------------------------------------------------------------
    // EXAMPLE MARKERS 
    // partner marker
    const wrap1 = document.createElement('div');
    const m1 = document.createElement('div');
    m1.className = "marker";
    m1.style.backgroundImage = "url('./img1.png')";
    wrap1.appendChild(m1);

    addHoverMarker({
      lngLat: [-73.98513, 40.75890], // Times Sq
      element: wrap1,
      title: 'Place one',
      type: 'partner',
      address: "123 banana Street"
    });

    // resource marker
    const wrap3 = document.createElement('div');
    const m3 = document.createElement('div');
    m3.className = "marker";
    m3.style.backgroundImage = "url('./img2.png')";
    wrap3.appendChild(m3);

    addHoverMarker({
      lngLat: [-73.78513, 40.75890],
      element: wrap3,
      title: 'Place two',
       type: 'partner',
      address: "123 banana Street"
    });


        // resource marker
    const wrap4 = document.createElement('div');
    const m4 = document.createElement('div');
    m4.className = "marker";
    m4.style.backgroundImage = "url('./img3.png')";
    wrap4.appendChild(m4);

    addHoverMarker({
      lngLat: [-73.86513, 40.75890],
      element: wrap4,
      title: 'Place three',
       type: 'resource',
      address: "123 banana Street"
    });

        // resource marker
    const wrap2 = document.createElement('div');
    const m2 = document.createElement('div');
    m2.className = "marker";
    m2.style.backgroundImage = "url('./img4.png')";
    wrap2.appendChild(m2);

    addHoverMarker({
      lngLat: [-73.88513, 40.75890],
      element: wrap2,
      title: 'Place four',
      type: 'resource',
      address: "123 banana Street"
    });
    // ---------------------------------------------------------------------------
    // FILTER BUTTONS
    const purpleBtn = document.getElementById('purpleBtn');
    const redBtn = document.getElementById('redBtn');
    const blueBtn = document.getElementById('blueBtn');

    purpleBtn.addEventListener('click', () => {
      setActiveBtn('purpleBtn');
      applyFilter('all');
    });

    redBtn.addEventListener('click', () => {
      setActiveBtn('redBtn');
      applyFilter('partner');
    });

    blueBtn.addEventListener('click', () => {
      setActiveBtn('blueBtn');
      applyFilter('resource');
    });

    // start on "all"
    applyFilter('all');

    // ---------------------------------------------------------------------------
    map.on('style.load', () => {
      map.setFog({});
    });
  </script>
</body>
</html>
